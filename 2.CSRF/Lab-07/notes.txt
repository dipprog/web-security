Lab #7 - CSRF where Referer validation depends on header being present

Vulnerable parameter - email change functionality

Goal - exploit CSRF to change email address

Creds - wiener:peter

Analysis - 

In order for a CSRF attack to be possible:
1. A relevant action - change a user's email
2. Cookie based session handling - session cookie
3. No unpredictable request parameters - no CSRF token

Referer header: It is a http optional request header that contains the URL of the page making the request. It determining from where a certain request is originating from. Some application makes use of referer header to attempt to defend against CSRF attack by making sure that the request originated from same domain as the application's domain. This in general is not a good way to defend against CSRF, because it can be spoofed.

Testing Referer header for CSRF attacks:
1. Remove the Referer header - referer defense mechanism is not properly implemented.
